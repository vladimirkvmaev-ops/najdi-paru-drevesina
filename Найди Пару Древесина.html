<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞–π–¥–∏ –ø–∞—Ä—É: –î—Ä–µ–≤–µ—Å–∏–Ω–∞ - –ò–≥—Ä–∞ –ø–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è 5 –∫–ª–∞—Å—Å–∞</title>
    <style>
        :root {
            --bg-primary: #E3F2FD;
            --bg-card: #FFF9C4;
            --bg-card-flipped: #C8E6C9;
            --btn-primary: #FF9800;
            --btn-hover: #F57C00;
            --text-primary: #3E2723;
            --text-light: #6D4C41;
            --border-color: #BCAAA4;
            --shadow: rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Arial', sans-serif;
            background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(139, 69, 19, 0.03) 50px, rgba(139, 69, 19, 0.03) 51px),
                repeating-linear-gradient(0deg, transparent, transparent 50px, rgba(139, 69, 19, 0.03) 50px, rgba(139, 69, 19, 0.03) 51px);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            width: 100%;
        }

        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--text-primary);
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
        }

        .menu-screen {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px var(--shadow);
            max-width: 600px;
            margin: 0 auto;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            font-size: 1.1rem;
            border: 3px solid var(--border-color);
            border-radius: 10px;
            background: #FFF9C4;
        }

        .difficulty-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px var(--shadow);
            color: white;
        }

        .btn-primary {
            background: var(--btn-primary);
        }

        .btn-primary:hover {
            background: var(--btn-hover);
            transform: translateY(-2px);
            box-shadow: 0 7px 20px var(--shadow);
        }

        .btn-secondary {
            background: #4CAF50;
        }

        .btn-secondary:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .btn-difficulty {
            background: #64B5F6;
            color: white;
            border: 3px solid transparent;
        }

        .btn-difficulty.selected {
            background: #1976D2;
            border: 3px solid #0D47A1;
            transform: scale(1.05);
        }

        .game-screen {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px var(--shadow);
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #FFF9C4;
            border-radius: 15px;
        }

        .game-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .info-item {
            font-size: 1.2rem;
            font-weight: bold;
            padding: 10px 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px var(--shadow);
        }

        .timer {
            color: #1976D2;
        }

        .timer.warning {
            color: #F44336;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .game-controls {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 10px 15px;
            font-size: 0.9rem;
        }

        .game-board {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
            perspective: 1000px;
        }

        @media (min-width: 768px) {
            .game-board.grid-4x3 {
                grid-template-columns: repeat(4, 1fr);
            }
            .game-board.grid-4x4 {
                grid-template-columns: repeat(4, 1fr);
            }
            .game-board.grid-5x4 {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .card {
            aspect-ratio: 3/4;
            position: relative;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.matched {
            animation: matchAnimation 0.6s ease;
        }

        .card.wrong {
            animation: shakeAnimation 0.5s ease;
        }

        @keyframes matchAnimation {
            0%, 100% { transform: rotateY(180deg) scale(1); }
            50% { transform: rotateY(180deg) scale(1.1); }
        }

        @keyframes shakeAnimation {
            0%, 100% { transform: rotateY(180deg) translateX(0); }
            25% { transform: rotateY(180deg) translateX(-10px); }
            75% { transform: rotateY(180deg) translateX(10px); }
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px;
            box-shadow: 0 4px 8px var(--shadow);
        }

        .card-back {
            background: var(--bg-card);
            border: 4px solid var(--border-color);
        }

        .card-back::before {
            content: 'üå≤';
            font-size: 3rem;
        }

        .card-front {
            background: var(--bg-card-flipped);
            border: 4px solid #66BB6A;
            transform: rotateY(180deg);
        }

        .card-emoji {
            font-size: 3rem;
            margin-bottom: 5px;
        }

        .card-text {
            font-size: 0.9rem;
            font-weight: bold;
            text-align: center;
            color: var(--text-primary);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .modal-content p {
            font-size: 1.2rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .stars {
            font-size: 3rem;
            margin: 20px 0;
        }

        .explanation-modal .modal-content {
            background: linear-gradient(135deg, #C8E6C9 0%, #A5D6A7 100%);
        }

        .records-list {
            text-align: left;
            margin: 20px 0;
        }

        .record-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #FFF9C4;
            border-radius: 10px;
            font-weight: bold;
        }

        .admin-screen {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px var(--shadow);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: #FFF9C4;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 8px var(--shadow);
        }

        .stat-card h3 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-light);
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 3px solid var(--border-color);
            border-radius: 10px;
            font-family: monospace;
            font-size: 0.9rem;
            resize: vertical;
        }

        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .menu-screen {
                padding: 20px;
            }

            .game-header {
                flex-direction: column;
            }

            .card-emoji {
                font-size: 2rem;
            }

            .card-text {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <canvas id="confetti-canvas"></canvas>
    
    <div class="container">
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="menu-screen" class="screen active">
            <div class="menu-screen">
                <h1>üå≤ –ù–∞–π–¥–∏ –ø–∞—Ä—É: –î—Ä–µ–≤–µ—Å–∏–Ω–∞ ü™µ</h1>
                <p style="text-align: center; font-size: 1.1rem; margin-bottom: 30px;">–ò–≥—Ä–∞ –ø–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è 5 –∫–ª–∞—Å—Å–∞</p>
                
                <div class="input-group">
                    <label for="player-name">–¢–≤–æ—ë –∏–º—è:</label>
                    <input type="text" id="player-name" placeholder="–í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è" maxlength="20">
                </div>

                <div class="input-group">
                    <label>–í—ã–±–µ—Ä–∏ —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏:</label>
                    <div class="difficulty-buttons">
                        <button class="btn btn-difficulty" data-level="easy">
                            üòä –õ–µ–≥–∫–∏–π<br><small>6 –ø–∞—Ä, 60 —Å–µ–∫</small>
                        </button>
                        <button class="btn btn-difficulty selected" data-level="medium">
                            üòé –°—Ä–µ–¥–Ω–∏–π<br><small>8 –ø–∞—Ä, 90 —Å–µ–∫</small>
                        </button>
                        <button class="btn btn-difficulty" data-level="hard">
                            üî• –°–ª–æ–∂–Ω—ã–π<br><small>10 –ø–∞—Ä, 120 —Å–µ–∫</small>
                        </button>
                    </div>
                </div>

                <button class="btn btn-primary" id="start-game" style="width: 100%; margin-bottom: 15px;">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É!</button>
                <button class="btn btn-secondary" id="show-records" style="width: 100%; margin-bottom: 15px;">üèÜ –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</button>
                <button class="btn btn-secondary" id="show-rules" style="width: 100%; margin-bottom: 15px;">üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</button>
                <button class="btn btn-secondary" id="show-admin" style="width: 100%;">üë®‚Äçüè´ –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</button>
            </div>
        </div>

        <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
        <div id="game-screen" class="screen">
            <div class="game-screen">
                <h1>üå≤ –ù–∞–π–¥–∏ –ø–∞—Ä—É ü™µ</h1>
                
                <div class="game-header">
                    <div class="game-info">
                        <div class="info-item timer">‚è±Ô∏è <span id="timer">90</span> —Å–µ–∫</div>
                        <div class="info-item">‚≠ê <span id="score">0</span> –æ—á–∫–æ–≤</div>
                        <div class="info-item">üéØ <span id="pairs-found">0</span>/<span id="total-pairs">8</span></div>
                    </div>
                    <div class="game-controls">
                        <button class="btn btn-secondary btn-small" id="pause-btn">‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                        <button class="btn btn-primary btn-small" id="exit-btn">üö™ –í—ã—Ö–æ–¥</button>
                    </div>
                </div>

                <div id="game-board" class="game-board grid-4x4"></div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ -->
        <div id="admin-screen" class="screen">
            <div class="admin-screen">
                <h1>üë®‚Äçüè´ –ü–∞–Ω–µ–ª—å —É—á–∏—Ç–µ–ª—è</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>–í—Å–µ–≥–æ –∏–≥—Ä</h3>
                        <div class="value" id="total-games">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª</h3>
                        <div class="value" id="avg-score">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                        <div class="value" id="best-score">0</div>
                    </div>
                </div>

                <h2 style="margin: 30px 0 15px;">üìä –°–∞–º—ã–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä—ã:</h2>
                <div id="difficult-pairs" style="background: #FFF9C4; padding: 20px; border-radius: 15px; margin-bottom: 30px;">
                    <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –∏–≥—Ä</p>
                </div>

                <h2 style="margin: 30px 0 15px;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (JSON):</h2>
                <textarea id="content-editor"></textarea>
                <div style="display: flex; gap: 15px; margin-top: 15px;">
                    <button class="btn btn-primary" id="save-content">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                    <button class="btn btn-secondary" id="export-stats">üì• –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ CSV</button>
                    <button class="btn btn-primary" id="back-to-menu">üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="explanation-modal" class="modal explanation-modal">
        <div class="modal-content">
            <h2>‚úÖ –û—Ç–ª–∏—á–Ω–æ!</h2>
            <p id="explanation-text"></p>
            <button class="btn btn-primary" onclick="closeExplanation()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>

    <div id="victory-modal" class="modal">
        <div class="modal-content">
            <h2>üéâ –ü–æ–±–µ–¥–∞!</h2>
            <div class="stars" id="stars-display"></div>
            <p><strong>–¢–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong></p>
            <p>‚≠ê –û—á–∫–∏: <strong id="final-score">0</strong></p>
            <p>‚è±Ô∏è –í—Ä–µ–º—è: <strong id="time-spent">0</strong> —Å–µ–∫</p>
            <p>üéØ –ù–∞–π–¥–µ–Ω–æ –ø–∞—Ä: <strong id="pairs-result">0</strong></p>
            <button class="btn btn-primary" onclick="returnToMenu()">–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é</button>
            <button class="btn btn-secondary" onclick="playAgain()">–ò–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
        </div>
    </div>

    <div id="records-modal" class="modal">
        <div class="modal-content">
            <h2>üèÜ –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</h2>
            <div class="records-list" id="records-list"></div>
            <button class="btn btn-primary" onclick="closeRecords()">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button class="btn btn-secondary" onclick="clearRecords()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∫–æ—Ä–¥—ã</button>
        </div>
    </div>

    <div id="rules-modal" class="modal">
        <div class="modal-content">
            <h2>üìñ –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã</h2>
            <div style="text-align: left; line-height: 1.8;">
                <p><strong>–¶–µ–ª—å –∏–≥—Ä—ã:</strong> –Ω–∞–π—Ç–∏ –≤—Å–µ –ø–∞—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫ –∑–∞ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–µ –≤—Ä–µ–º—è.</p>
                <p><strong>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</strong></p>
                <ul style="margin-left: 20px;">
                    <li>–û—Ç–∫—Ä—ã–≤–∞–π –ø–æ –¥–≤–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞ —Ä–∞–∑</li>
                    <li>–ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å–≤—è–∑–∞–Ω—ã - –ø–∞—Ä–∞ –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ–π</li>
                    <li>–ï—Å–ª–∏ –Ω–µ—Ç - –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è</li>
                    <li>–ó–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—É: +10 –æ—á–∫–æ–≤</li>
                    <li>–ó–∞ –æ—à–∏–±–∫—É: -2 –æ—á–∫–∞</li>
                    <li>–ë–æ–Ω—É—Å –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å: +1 –æ—á–∫–æ –∑–∞ —Å–µ–∫—É–Ω–¥—É</li>
                </ul>
                <p><strong>–£—Ä–æ–≤–Ω–∏:</strong></p>
                <ul style="margin-left: 20px;">
                    <li>–õ–µ–≥–∫–∏–π: 6 –ø–∞—Ä, 60 —Å–µ–∫—É–Ω–¥, –ø–æ–¥—Å–∫–∞–∑–∫–∞</li>
                    <li>–°—Ä–µ–¥–Ω–∏–π: 8 –ø–∞—Ä, 90 —Å–µ–∫—É–Ω–¥</li>
                    <li>–°–ª–æ–∂–Ω—ã–π: 10 –ø–∞—Ä, 120 —Å–µ–∫—É–Ω–¥</li>
                </ul>
            </div>
            <button class="btn btn-primary" onclick="closeRules()">–ü–æ–Ω—è—Ç–Ω–æ!</button>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
        const gameData = {
            pairs: [
                {
                    id: 1,
                    card1: { emoji: "üå≥", text: "–î—É–±" },
                    card2: { emoji: "ü™ë", text: "–ü—Ä–æ—á–Ω–∞—è –º–µ–±–µ–ª—å" },
                    explanation: "–î—É–± üå≥ ‚Üí –ú–µ–±–µ–ª—å ü™ë: –î—É–± - –æ—á–µ–Ω—å –ø—Ä–æ—á–Ω–∞—è –ø–æ—Ä–æ–¥–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã —Å –∫—Ä–∞—Å–∏–≤–æ–π —Ç–µ–∫—Å—Ç—É—Ä–æ–π, –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ–π –º–µ–±–µ–ª–∏!"
                },
                {
                    id: 2,
                    card1: { emoji: "üå≤", text: "–°–æ—Å–Ω–∞" },
                    card2: { emoji: "üè†", text: "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ" },
                    explanation: "–°–æ—Å–Ω–∞ üå≤ ‚Üí –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ üè†: –°–æ—Å–Ω–∞ - –¥–æ—Å—Ç—É–ø–Ω–∞—è –∏ –ø—Ä–æ—á–Ω–∞—è –¥—Ä–µ–≤–µ—Å–∏–Ω–∞, —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–µ –¥–æ–º–æ–≤ –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π!"
                },
                {
                    id: 3,
                    card1: { emoji: "üå≥", text: "–ë–µ—Ä–µ–∑–∞" },
                    card2: { emoji: "üì¶", text: "–§–∞–Ω–µ—Ä–∞" },
                    explanation: "–ë–µ—Ä–µ–∑–∞ üå≥ ‚Üí –§–∞–Ω–µ—Ä–∞ üì¶: –ò–∑ –±–µ—Ä–µ–∑—ã –¥–µ–ª–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Ñ–∞–Ω–µ—Ä—É - –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –º–µ–±–µ–ª–∏ –∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞!"
                },
                {
                    id: 4,
                    card1: { emoji: "üå≥", text: "–õ–∏–ø–∞" },
                    card2: { emoji: "üé®", text: "–†–µ–∑—å–±–∞ –ø–æ –¥–µ—Ä–µ–≤—É" },
                    explanation: "–õ–∏–ø–∞ üå≥ ‚Üí –†–µ–∑—å–±–∞ üé®: –õ–∏–ø–∞ - –º—è–≥–∫–∞—è –¥—Ä–µ–≤–µ—Å–∏–Ω–∞, –ª–µ–≥–∫–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è —Ä–µ–∑—å–±—ã –∏ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π!"
                },
                {
                    id: 5,
                    card1: { emoji: "üè≠", text: "–ü–∏–ª–æ—Ä–∞–º–∞" },
                    card2: { emoji: "ü™µ", text: "–î–æ—Å–∫–∏" },
                    explanation: "–ü–∏–ª–æ—Ä–∞–º–∞ üè≠ ‚Üí –î–æ—Å–∫–∏ ü™µ: –ù–∞ –ø–∏–ª–æ—Ä–∞–º–µ –±—Ä–µ–≤–Ω–∞ —Ä–∞—Å–ø–∏–ª–∏–≤–∞—é—Ç –Ω–∞ –¥–æ—Å–∫–∏ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞!"
                },
                {
                    id: 6,
                    card1: { emoji: "ü™ì", text: "–õ–µ—Å–æ–∑–∞–≥–æ—Ç–æ–≤–∫–∞" },
                    card2: { emoji: "ü™µ", text: "–ë—Ä–µ–≤–Ω–∞" },
                    explanation: "–õ–µ—Å–æ–∑–∞–≥–æ—Ç–æ–≤–∫–∞ ü™ì ‚Üí –ë—Ä–µ–≤–Ω–∞ ü™µ: –î–µ—Ä–µ–≤—å—è —Å–ø–∏–ª–∏–≤–∞—é—Ç –∏ –≤—ã–≤–æ–∑—è—Ç –∏–∑ –ª–µ—Å–∞ –≤ –≤–∏–¥–µ –±—Ä–µ–≤–µ–Ω –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏!"
                },
                {
                    id: 7,
                    card1: { emoji: "üå°Ô∏è", text: "–°—É—à–∫–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã" },
                    card2: { emoji: "‚úÖ", text: "–ö–∞—á–µ—Å—Ç–≤–æ" },
                    explanation: "–°—É—à–∫–∞ üå°Ô∏è ‚Üí –ö–∞—á–µ—Å—Ç–≤–æ ‚úÖ: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—É—à–∫–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ —Ä–∞—Å—Ç—Ä–µ—Å–∫–∏–≤–∞–Ω–∏–µ –∏–∑–¥–µ–ª–∏–π!"
                },
                {
                    id: 8,
                    card1: { emoji: "üîß", text: "–¢–æ–∫–∞—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫" },
                    card2: { emoji: "‚öôÔ∏è", text: "–ö—Ä—É–≥–ª—ã–µ –¥–µ—Ç–∞–ª–∏" },
                    explanation: "–¢–æ–∫–∞—Ä–Ω—ã–π —Å—Ç–∞–Ω–æ–∫ üîß ‚Üí –î–µ—Ç–∞–ª–∏ ‚öôÔ∏è: –ù–∞ —Ç–æ–∫–∞—Ä–Ω–æ–º —Å—Ç–∞–Ω–∫–µ –≤—ã—Ç–∞—á–∏–≤–∞—é—Ç –∫—Ä—É–≥–ª—ã–µ –∏–∑–¥–µ–ª–∏—è - –Ω–æ–∂–∫–∏ —Å—Ç–æ–ª–æ–≤, —Ä—É—á–∫–∏, –¥–µ–∫–æ—Ä!"
                },
                {
                    id: 9,
                    card1: { emoji: "üéª", text: "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã" },
                    card2: { emoji: "üéµ", text: "–ï–ª—å" },
                    explanation: "–ï–ª—å üéµ ‚Üí –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã üéª: –ò–∑ –µ–ª–∏ –¥–µ–ª–∞—é—Ç —Å–∫—Ä–∏–ø–∫–∏ –∏ –≥–∏—Ç–∞—Ä—ã - —ç—Ç–∞ –¥—Ä–µ–≤–µ—Å–∏–Ω–∞ –æ—Ç–ª–∏—á–Ω–æ —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç –∑–≤—É–∫!"
                },
                {
                    id: 10,
                    card1: { emoji: "‚úèÔ∏è", text: "–ö–∞—Ä–∞–Ω–¥–∞—à" },
                    card2: { emoji: "üå≤", text: "–ö–µ–¥—Ä" },
                    explanation: "–ö–µ–¥—Ä üå≤ ‚Üí –ö–∞—Ä–∞–Ω–¥–∞—à ‚úèÔ∏è: –ö–µ–¥—Ä–æ–≤–∞—è –¥—Ä–µ–≤–µ—Å–∏–Ω–∞ –º—è–≥–∫–∞—è –∏ –ª–µ–≥–∫–æ –∑–∞—Ç–∞—á–∏–≤–∞–µ—Ç—Å—è, –∏–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä–∞–Ω–¥–∞—à–µ–π!"
                }
            ]
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let selectedLevel = 'medium';
        let playerName = '';
        let gameTimer = null;
        let timeLeft = 90;
        let score = 0;
        let pairsFound = 0;
        let totalPairs = 8;
        let flippedCards = [];
        let matchedPairs = [];
        let canFlip = true;
        let isPaused = false;
        let gameStartTime = null;
        let mistakes = 0;

        // –ê—É–¥–∏–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∑–≤—É–∫–æ–≤
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'flip':
                    oscillator.frequency.value = 300;
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.1);
                    break;
                case 'match':
                    oscillator.frequency.value = 523.25;
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                case 'error':
                    oscillator.frequency.value = 200;
                    gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.2);
                    break;
                case 'victory':
                    [523.25, 587.33, 659.25, 783.99].forEach((freq, i) => {
                        const osc = audioContext.createOscillator();
                        const gain = audioContext.createGain();
                        osc.connect(gain);
                        gain.connect(audioContext.destination);
                        osc.frequency.value = freq;
                        gain.gain.setValueAtTime(0.2, audioContext.currentTime + i * 0.15);
                        osc.start(audioContext.currentTime + i * 0.15);
                        osc.stop(audioContext.currentTime + i * 0.15 + 0.3);
                    });
                    break;
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            loadGameData();
            setupEventListeners();
            updateAdminStats();
        });

        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∏ —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            document.querySelectorAll('.btn-difficulty').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.btn-difficulty').forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedLevel = btn.dataset.level;
                });
            });

            // –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã
            document.getElementById('start-game').addEventListener('click', startGame);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∫–æ—Ä–¥—ã
            document.getElementById('show-records').addEventListener('click', showRecords);
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞
            document.getElementById('show-rules').addEventListener('click', () => {
                document.getElementById('rules-modal').classList.add('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –∞–¥–º–∏–Ω–∫—É
            document.getElementById('show-admin').addEventListener('click', showAdmin);
            
            // –ò–≥—Ä–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
            document.getElementById('pause-btn').addEventListener('click', togglePause);
            document.getElementById('exit-btn').addEventListener('click', () => {
                if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∏–≥—Ä—ã? –ü—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω.')) {
                    returnToMenu();
                }
            });
            
            // –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
            document.getElementById('save-content').addEventListener('click', saveContent);
            document.getElementById('export-stats').addEventListener('click', exportStats);
            document.getElementById('back-to-menu').addEventListener('click', returnToMenu);
        }

        function startGame() {
            playerName = document.getElementById('player-name').value.trim() || '–ò–≥—Ä–æ–∫';
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω—è
            const levels = {
                easy: { pairs: 6, time: 60, preview: 3000 },
                medium: { pairs: 8, time: 90, preview: 2000 },
                hard: { pairs: 10, time: 120, preview: 0 }
            };
            
            const level = levels[selectedLevel];
            totalPairs = level.pairs;
            timeLeft = level.time;
            score = 0;
            pairsFound = 0;
            mistakes = 0;
            flippedCards = [];
            matchedPairs = [];
            canFlip = true;
            isPaused = false;
            gameStartTime = Date.now();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
            document.getElementById('timer').textContent = timeLeft;
            document.getElementById('score').textContent = score;
            document.getElementById('pairs-found').textContent = pairsFound;
            document.getElementById('total-pairs').textContent = totalPairs;
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
            createGameBoard(level.pairs);
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
            showScreen('game-screen');
            
            // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞—Ä—Ç
            if (level.preview > 0) {
                showPreview(level.preview);
            } else {
                startTimer();
            }
        }

        function createGameBoard(numPairs) {
            const board = document.getElementById('game-board');
            board.innerHTML = '';
            
            // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–∫–∏
            const gridClass = numPairs === 6 ? 'grid-4x3' : numPairs === 8 ? 'grid-4x4' : 'grid-5x4';
            board.className = `game-board ${gridClass}`;
            
            // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
            const selectedPairs = gameData.pairs.slice(0, numPairs);
            const cards = [];
            
            selectedPairs.forEach(pair => {
                cards.push({ ...pair.card1, pairId: pair.id, explanation: pair.explanation });
                cards.push({ ...pair.card2, pairId: pair.id, explanation: pair.explanation });
            });
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ
            shuffleArray(cards);
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫
            cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card';
                cardElement.dataset.index = index;
                cardElement.dataset.pairId = card.pairId;
                cardElement.dataset.explanation = card.explanation;
                
                cardElement.innerHTML = `
                    <div class="card-face card-back"></div>
                    <div class="card-face card-front">
                        <div class="card-emoji">${card.emoji}</div>
                        <div class="card-text">${card.text}</div>
                    </div>
                `;
                
                cardElement.addEventListener('click', () => flipCard(cardElement));
                board.appendChild(cardElement);
            });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function showPreview(duration) {
            document.querySelectorAll('.card').forEach(card => {
                card.classList.add('flipped');
            });
            
            setTimeout(() => {
                document.querySelectorAll('.card').forEach(card => {
                    card.classList.remove('flipped');
                });
                startTimer();
            }, duration);
        }

        function startTimer() {
            gameTimer = setInterval(() => {
                if (!isPaused) {
                    timeLeft--;
                    document.getElementById('timer').textContent = timeLeft;
                    
                    const timerElement = document.querySelector('.timer');
                    if (timeLeft <= 10) {
                        timerElement.classList.add('warning');
                        if (timeLeft > 0) playSound('flip');
                    }
                    
                    if (timeLeft <= 0) {
                        endGame(false);
                    }
                }
            }, 1000);
        }

        function flipCard(card) {
            if (!canFlip || isPaused || card.classList.contains('flipped') || card.classList.contains('matched')) {
                return;
            }
            
            playSound('flip');
            card.classList.add('flipped');
            flippedCards.push(card);
            
            if (flippedCards.length === 2) {
                canFlip = false;
                checkMatch();
            }
        }

        function checkMatch() {
            const [card1, card2] = flippedCards;
            const pair1 = card1.dataset.pairId;
            const pair2 = card2.dataset.pairId;
            
            setTimeout(() => {
                if (pair1 === pair2) {
                    // –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ!
                    playSound('match');
                    card1.classList.add('matched');
                    card2.classList.add('matched');
                    matchedPairs.push(pair1);
                    pairsFound++;
                    score += 10;
                    
                    document.getElementById('pairs-found').textContent = pairsFound;
                    document.getElementById('score').textContent = score;
                    
                    // –ü–æ–∫–∞–∑–∞—Ç—å –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
                    showExplanation(card1.dataset.explanation);
                    
                    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫
                    savePairStats(pair1, true);
                    
                    if (pairsFound === totalPairs) {
                        setTimeout(() => endGame(true), 1000);
                    }
                } else {
                    // –ù–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
                    playSound('error');
                    card1.classList.add('wrong');
                    card2.classList.add('wrong');
                    mistakes++;
                    score = Math.max(0, score - 2);
                    document.getElementById('score').textContent = score;
                    
                    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—à–∏–±–æ–∫
                    savePairStats(pair1, false);
                    
                    setTimeout(() => {
                        card1.classList.remove('flipped', 'wrong');
                        card2.classList.remove('flipped', 'wrong');
                    }, 1000);
                }
                
                flippedCards = [];
                canFlip = true;
            }, 800);
        }

        function showExplanation(text) {
            document.getElementById('explanation-text').textContent = text;
            document.getElementById('explanation-modal').classList.add('active');
        }

        function closeExplanation() {
            document.getElementById('explanation-modal').classList.remove('active');
        }

        function togglePause() {
            isPaused = !isPaused;
            const btn = document.getElementById('pause-btn');
            btn.textContent = isPaused ? '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '‚è∏Ô∏è –ü–∞—É–∑–∞';
        }

        function endGame(victory) {
            clearInterval(gameTimer);
            
            if (victory) {
                playSound('victory');
                
                // –ë–æ–Ω—É—Å –∑–∞ –≤—Ä–µ–º—è
                const timeBonus = timeLeft;
                score += timeBonus;
                
                // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–≤–µ–∑–¥
                let stars = '‚≠ê';
                if (score >= 80) stars = '‚≠ê‚≠ê‚≠ê';
                else if (score >= 50) stars = '‚≠ê‚≠ê';
                
                document.getElementById('stars-display').textContent = stars;
                document.getElementById('final-score').textContent = score;
                document.getElementById('time-spent').textContent = (Date.now() - gameStartTime) / 1000;
                document.getElementById('pairs-result').textContent = pairsFound + '/' + totalPairs;
                
                // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ—Ä–¥–∞
                saveRecord(playerName, score, selectedLevel);
                
                // –ö–æ–Ω—Ñ–µ—Ç—Ç–∏
                createConfetti();
                
                document.getElementById('victory-modal').classList.add('active');
            } else {
                alert('‚è∞ –í—Ä–µ–º—è –≤—ã—à–ª–æ! –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑.');
                returnToMenu();
            }
        }

        function createConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const particles = [];
            const colors = ['#FF9800', '#FFC107', '#4CAF50', '#2196F3', '#9C27B0', '#F44336'];
            
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: -10,
                    vx: (Math.random() - 0.5) * 4,
                    vy: Math.random() * 3 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 8 + 4
                });
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach((p, index) => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += 0.1;
                    
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    
                    if (p.y > canvas.height) {
                        particles.splice(index, 1);
                    }
                });
                
                if (particles.length > 0) {
                    requestAnimationFrame(animate);
                } else {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                }
            }
            
            animate();
        }

        function saveRecord(name, points, level) {
            const records = JSON.parse(localStorage.getItem('woodRecords') || '[]');
            records.push({
                name: name,
                score: points,
                level: level,
                date: new Date().toLocaleDateString('ru-RU')
            });
            
            records.sort((a, b) => b.score - a.score);
            localStorage.setItem('woodRecords', JSON.stringify(records.slice(0, 10)));
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            updateGameStats(points, mistakes);
        }

        function updateGameStats(finalScore, errorCount) {
            const stats = JSON.parse(localStorage.getItem('woodStats') || '{"totalGames": 0, "totalScore": 0, "totalMistakes": 0}');
            stats.totalGames++;
            stats.totalScore += finalScore;
            stats.totalMistakes += errorCount;
            localStorage.setItem('woodStats', JSON.stringify(stats));
        }

        function savePairStats(pairId, isCorrect) {
            const pairStats = JSON.parse(localStorage.getItem('woodPairStats') || '{}');
            if (!pairStats[pairId]) {
                pairStats[pairId] = { attempts: 0, errors: 0 };
            }
            pairStats[pairId].attempts++;
            if (!isCorrect) pairStats[pairId].errors++;
            localStorage.setItem('woodPairStats', JSON.stringify(pairStats));
        }

        function showRecords() {
            const records = JSON.parse(localStorage.getItem('woodRecords') || '[]');
            const list = document.getElementById('records-list');
            
            if (records.length === 0) {
                list.innerHTML = '<p style="text-align: center;">–†–µ–∫–æ—Ä–¥–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –°—ã–≥—Ä–∞–π –ø–µ—Ä–≤—ã–º!</p>';
            } else {
                list.innerHTML = records.slice(0, 5).map((record, index) => `
                    <div class="record-item">
                        <span>${index + 1}. ${record.name}</span>
                        <span>${record.score} –æ—á–∫–æ–≤ (${record.level}) - ${record.date}</span>
                    </div>
                `).join('');
            }
            
            document.getElementById('records-modal').classList.add('active');
        }

        function closeRecords() {
            document.getElementById('records-modal').classList.remove('active');
        }

        function clearRecords() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ä–µ–∫–æ—Ä–¥—ã?')) {
                localStorage.removeItem('woodRecords');
                closeRecords();
            }
        }

        function closeRules() {
            document.getElementById('rules-modal').classList.remove('active');
        }

        function returnToMenu() {
            clearInterval(gameTimer);
            showScreen('menu-screen');
            document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
        }

        function playAgain() {
            document.getElementById('victory-modal').classList.remove('active');
            startGame();
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function showAdmin() {
            updateAdminStats();
            document.getElementById('content-editor').value = JSON.stringify(gameData, null, 2);
            showScreen('admin-screen');
        }

        function updateAdminStats() {
            const stats = JSON.parse(localStorage.getItem('woodStats') || '{"totalGames": 0, "totalScore": 0}');
            const records = JSON.parse(localStorage.getItem('woodRecords') || '[]');
            
            document.getElementById('total-games').textContent = stats.totalGames;
            document.getElementById('avg-score').textContent = stats.totalGames > 0 
                ? Math.round(stats.totalScore / stats.totalGames) 
                : 0;
            document.getElementById('best-score').textContent = records.length > 0 
                ? records[0].score 
                : 0;
            
            // –°–ª–æ–∂–Ω—ã–µ –ø–∞—Ä—ã
            const pairStats = JSON.parse(localStorage.getItem('woodPairStats') || '{}');
            const difficult = Object.entries(pairStats)
                .map(([id, data]) => ({
                    id: id,
                    errorRate: data.errors / data.attempts,
                    errors: data.errors,
                    attempts: data.attempts
                }))
                .sort((a, b) => b.errorRate - a.errorRate)
                .slice(0, 3);
            
            const difficultDiv = document.getElementById('difficult-pairs');
            if (difficult.length > 0) {
                difficultDiv.innerHTML = difficult.map(p => {
                    const pair = gameData.pairs.find(pair => pair.id == p.id);
                    return `<p>üìä ${pair.card1.text} ‚Üî ${pair.card2.text}: ${p.errors} –æ—à–∏–±–æ–∫ –∏–∑ ${p.attempts} –ø–æ–ø—ã—Ç–æ–∫ (${Math.round(p.errorRate * 100)}%)</p>`;
                }).join('');
            }
        }

        function saveContent() {
            try {
                const newData = JSON.parse(document.getElementById('content-editor').value);
                gameData.pairs = newData.pairs;
                localStorage.setItem('woodGameData', JSON.stringify(gameData));
                alert('‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
            } catch (e) {
                alert('‚ùå –û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON! –ü—Ä–æ–≤–µ—Ä—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.');
            }
        }

        function loadGameData() {
            const saved = localStorage.getItem('woodGameData');
            if (saved) {
                const data = JSON.parse(saved);
                gameData.pairs = data.pairs;
            }
        }

        function exportStats() {
            const stats = JSON.parse(localStorage.getItem('woodStats') || '{}');
            const records = JSON.parse(localStorage.getItem('woodRecords') || '[]');
            const pairStats = JSON.parse(localStorage.getItem('woodPairStats') || '{}');
            
            let csv = '–¢–∏–ø,–î–∞–Ω–Ω—ã–µ\n';
            csv += `–í—Å–µ–≥–æ –∏–≥—Ä,${stats.totalGames}\n`;
            csv += `–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª,${stats.totalGames > 0 ? Math.round(stats.totalScore / stats.totalGames) : 0}\n`;
            csv += `\n–¢–æ–ø-5 —Ä–µ–∫–æ—Ä–¥–æ–≤\n`;
            csv += '–ò–º—è,–û—á–∫–∏,–£—Ä–æ–≤–µ–Ω—å,–î–∞—Ç–∞\n';
            records.slice(0, 5).forEach(r => {
                csv += `${r.name},${r.score},${r.level},${r.date}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞_–∏–≥—Ä—ã.csv';
            link.click();
        }
    </script>
</body>
</html>

